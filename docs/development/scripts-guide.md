# è„šæœ¬ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬ï¼š** 1.0
**æ—¥æœŸï¼š** 2025-11-02
**ç”¨é€”ï¼š** å¸®åŠ©å¿«é€Ÿæ‰¾åˆ°åˆé€‚çš„è„šæœ¬è¿›è¡Œæµ‹è¯•

---

## ğŸ¯ å¿«é€ŸæŸ¥æ‰¾

### æˆ‘æƒ³è¦...

| ç›®æ ‡ | æ¨èè„šæœ¬ | æ—¶é—´ | éš¾åº¦ |
|------|---------|------|------|
| **æµ‹è¯•å®Œæ•´æ•°æ®é‡‡é›†æµç¨‹** | `run_collection.py` | 2-3min | ç®€å• |
| **æŸ¥çœ‹ TOP 10 æ–°é—»** | `run_collection.py` (æŸ¥çœ‹è¾“å‡º) | è‡ªåŠ¨ | ç®€å• |
| **æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰æ•°æ®** | è‡ªå®šä¹‰SQLæŸ¥è¯¢è„šæœ¬ | 1min | ç®€å• |
| **é‡‡é›† + è¯„åˆ† + ç»Ÿè®¡** | `test-batch-scoring.py` | 5-10min | ä¸­ç­‰ |
| **è¯„åˆ†æœªè¯„åˆ†çš„æ–‡ç« ** | `score-raw-news.py` | 2-3min | ç®€å• |
| **æµ‹è¯•OpenAI API** | `test-real-api.py` | 1-2min | ç®€å• |
| **è¯Šæ–­æ•°æ®æºé—®é¢˜** | `diagnose-api.py` | 1-2min | ä¸­ç­‰ |
| **é…ç½®æºçš„é»˜è®¤author** | `configure_default_authors.py` | 1min | ç®€å• |

---

## ğŸ“‹ è„šæœ¬è¯¦ç»†è¯´æ˜

### 1ï¸âƒ£ **run_collection.py** (æ¨èç”¨äº P1-3 ç«¯åˆ°ç«¯æµ‹è¯•)

**åŠŸèƒ½ï¼š** å®Œæ•´çš„æ•°æ®é‡‡é›†è„šæœ¬ï¼ŒåŒ…æ‹¬ç»“æœå±•ç¤º

```bash
python scripts/run_collection.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ è¿æ¥åˆ°æ•°æ®åº“
- âœ“ ä» 15 ä¸ªæ•°æ®æºé‡‡é›†æ–°é—»
- âœ“ å»é‡å¹¶ä¿å­˜åˆ° raw_news è¡¨
- âœ“ æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
- âœ“ æ˜¾ç¤º TOP 10 æœ€æ–°æ–°é—»

**è¾“å‡ºåŒ…å«ï¼š**
```
[1] è¿æ¥æ•°æ®åº“...
[2] è·å–æ•°æ®æº...
[3] é‡‡é›†æ–°é—»...
[4] é‡‡é›†ç»Ÿè®¡
    æ€»é‡‡é›†: 100
    æ–°å¢: 82
    é‡å¤: 18
[5] æœ€æ–°æ–°é—» TOP 10
    1. [æ ‡é¢˜] ...
    2. [æ ‡é¢˜] ...
    ...
[6] æ•°æ®åº“æŸ¥è¯¢å‘½ä»¤
[7] ä¸‹ä¸€æ­¥å»ºè®®
```

**ç‰¹ç‚¹ï¼š**
- å¼‚æ­¥å¹¶å‘é‡‡é›† (15ä¸ªæºåŒæ—¶)
- è‡ªåŠ¨å»é‡ (SHA256 hash)
- è¯¦ç»†çš„è¿›åº¦å’Œé”™è¯¯æŠ¥å‘Š
- **åŒ…å« TOP 10 å±•ç¤º**

**æ¨èç”¨é€”ï¼š** âœ… **P1-3 ç«¯åˆ°ç«¯æµ‹è¯•çš„ç¬¬ä¸€æ­¥**

**è€—æ—¶ï¼š** 30-60 ç§’

---

### 2ï¸âƒ£ **test-batch-scoring.py** (æ¨èç”¨äºè¯„åˆ†æµ‹è¯•)

**åŠŸèƒ½ï¼š** æ‰¹é‡è¯„åˆ†é‡‡é›†çš„æ–°é—»

```bash
python scripts/test-batch-scoring.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ è·å–æœªè¯„åˆ†çš„åŸå§‹æ–°é—»
- âœ“ è°ƒç”¨ OpenAI API è¿›è¡Œè¯„åˆ†
- âœ“ ä¿å­˜è¯„åˆ†ç»“æœåˆ° processed_news
- âœ“ æ˜¾ç¤ºæˆæœ¬å’Œæ€§èƒ½ç»Ÿè®¡

**è¾“å‡ºåŒ…å«ï¼š**
```
å¼€å§‹è¯„åˆ† 50 æ¡æ–°é—»...
è¯„åˆ†ä¸­...
æˆåŠŸ: 50/50 (100%)
å¤±è´¥: 0
æˆæœ¬: $0.15
è€—æ—¶: 125 ç§’ (2.5 ç§’/æ¡)

è¯„åˆ†ç¤ºä¾‹:
  æ ‡é¢˜: AI æ¨¡å‹çªç ´...
  åˆ†æ•°: 87/100
  åˆ†ç±»: æŠ€æœ¯çªç ´, åˆ›æ–°
  æ‘˜è¦: ...
```

**ç‰¹ç‚¹ï¼š**
- æ‰¹å¤„ç†æ€§èƒ½ä¼˜åŒ–
- å®æ—¶æˆæœ¬è·Ÿè¸ª
- è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Š
- è¯„åˆ†ç»“æœå®Œæ•´æ€§éªŒè¯

**æ¨èç”¨é€”ï¼š** âœ… **P1-3 çš„ç¬¬äºŒæ­¥ (è¯„åˆ†éªŒè¯)**

**è€—æ—¶ï¼š** 2-5 åˆ†é’Ÿï¼ˆå–å†³äºæ–‡ç« æ•°é‡å’ŒAPIå»¶è¿Ÿï¼‰

---

### 3ï¸âƒ£ **score-raw-news.py** (ç”¨äºé‡æ–°è¯„åˆ†)

**åŠŸèƒ½ï¼š** å¯¹æŒ‡å®šçš„åŸå§‹æ–°é—»è¿›è¡Œè¯„åˆ†

```bash
python scripts/score-raw-news.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ æŸ¥è¯¢ raw_news è¡¨ä¸­æœªè¯„åˆ†çš„æ–‡ç« 
- âœ“ é€ä¸ªè°ƒç”¨ OpenAI API
- âœ“ ä¿å­˜è¯„åˆ†åˆ° processed_news
- âœ“ æ›´æ–° raw_news çŠ¶æ€

**è¾“å‡ºï¼š** ç®€æ´çš„è¿›åº¦æŠ¥å‘Š

**æ¨èç”¨é€”ï¼š**
- é‡æ–°è¯„åˆ†å¤±è´¥çš„æ–‡ç« 
- å•ç‹¬å¤„ç†æŸä¸ªæ¥æºçš„æ–‡ç« 
- å°è§„æ¨¡è¯„åˆ†ä»»åŠ¡

**è€—æ—¶ï¼š** å–å†³äºæ–‡ç« æ•°

---

### 4ï¸âƒ£ **test-real-api.py** (ç”¨äº API è¯Šæ–­)

**åŠŸèƒ½ï¼š** æµ‹è¯• OpenAI API è¿æ¥å’Œæ ¼å¼

```bash
python scripts/test-real-api.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ æµ‹è¯• OpenAI API è¿æ¥
- âœ“ å‘é€ç¤ºä¾‹è¯·æ±‚
- âœ“ éªŒè¯å“åº”æ ¼å¼
- âœ“ æ£€æŸ¥æˆæœ¬è®¡ç®—

**è¾“å‡ºï¼š**
```
Testing OpenAI API connection...
âœ“ API è¿æ¥æ­£å¸¸
âœ“ å“åº”æ ¼å¼æœ‰æ•ˆ
âœ“ æˆæœ¬è®¡ç®—: $0.02 per request
```

**æ¨èç”¨é€”ï¼š**
- éªŒè¯ API Key é…ç½®
- æ£€æŸ¥ API è¿é€šæ€§
- è¯Šæ–­æ ¼å¼é—®é¢˜

**è€—æ—¶ï¼š** 5-10 ç§’

---

### 5ï¸âƒ£ **diagnose-api.py** (ç”¨äºæ•…éšœæ’æŸ¥)

**åŠŸèƒ½ï¼š** è¯Šæ–­æ•°æ®æºé‡‡é›†é—®é¢˜

```bash
python scripts/diagnose-api.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ æµ‹è¯•æ¯ä¸ªæ•°æ®æºçš„è¿æ¥
- âœ“ éªŒè¯ RSS æ ¼å¼
- âœ“ æ£€æŸ¥ HTTP çŠ¶æ€
- âœ“ æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…

**è¾“å‡ºï¼š**
```
è¯Šæ–­æ•°æ®æº...
  OpenAI Blog:         âœ“ OK (HTTP 200)
  TechCrunch:         âœ“ OK (HTTP 200)
  Google DeepMind:    âœ— ERROR (HTTP 404)
  ...

ç»“æœ: 7/15 æºæ­£å¸¸, 8/15 æºæœ‰é—®é¢˜
```

**æ¨èç”¨é€”ï¼š**
- è¯†åˆ«æ— æ•ˆçš„æ•°æ®æº
- è°ƒè¯•é‡‡é›†å¤±è´¥
- ä¼˜åŒ–æ•°æ®æºåˆ—è¡¨

**è€—æ—¶ï¼š** 30-60 ç§’

---

### 6ï¸âƒ£ **configure_default_authors.py** (å…ƒæ•°æ®é…ç½®)

**åŠŸèƒ½ï¼š** é…ç½®æ•°æ®æºçš„é»˜è®¤ author

```bash
python scripts/configure_default_authors.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ è¯»å–é¢„å®šä¹‰çš„é»˜è®¤ä½œè€…æ˜ å°„
- âœ“ æ›´æ–° DataSource è¡¨
- âœ“ æ˜¾ç¤ºé…ç½®ç»“æœ

**æ¨èç”¨é€”ï¼š**
- é¦–æ¬¡è®¾ç½®é»˜è®¤ author
- æ‰¹é‡æ›´æ–°æ•°æ®æºå…ƒæ•°æ®

**è€—æ—¶ï¼š** 1-2 ç§’

---

### 7ï¸âƒ£ **add_data_sources.py** (æ•°æ®æºç®¡ç†)

**åŠŸèƒ½ï¼š** æ·»åŠ æ–°çš„æ•°æ®æº

```bash
python scripts/add_data_sources.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ è¯»å–é¢„å®šä¹‰çš„æ•°æ®æºåˆ—è¡¨
- âœ“ æ£€æŸ¥é‡å¤
- âœ“ æ·»åŠ åˆ°æ•°æ®åº“
- âœ“ æ˜¾ç¤ºç»Ÿè®¡

**æ¨èç”¨é€”ï¼š**
- åˆå§‹åŒ–æ•°æ®æº (P0-2 å·²å®Œæˆ)
- æ‰©å±•æ•°æ®æºåˆ—è¡¨

**è€—æ—¶ï¼š** 1-2 ç§’

---

### 8ï¸âƒ£ **test-batch-scoring.py** (å·²åœ¨ run_collection.py åä½¿ç”¨)

å‚è€ƒä¸Šæ–‡ #2

---

### ğŸ…¾ï¸ **demo-with-mock.py** (ç”¨äºæ¼”ç¤º)

**åŠŸèƒ½ï¼š** ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®çš„å®Œæ•´æ¼”ç¤º

```bash
python scripts/demo-with-mock.py
```

**åšä»€ä¹ˆï¼š**
- âœ“ åˆ›å»ºæ¨¡æ‹Ÿçš„é‡‡é›†æ•°æ®
- âœ“ è¿è¡Œè¯„åˆ†
- âœ“ æ˜¾ç¤ºç»“æœ

**ç‰¹ç‚¹ï¼š**
- ä¸éœ€è¦çœŸå® API Key
- ä¸éœ€è¦ç½‘ç»œè¿æ¥
- å¿«é€Ÿæ¼”ç¤º

**æ¨èç”¨é€”ï¼š**
- ç¦»çº¿æ¼”ç¤º
- å¼€å‘æµ‹è¯•
- åŸå‹éªŒè¯

**è€—æ—¶ï¼š** 5-10 ç§’

---

## ğŸ”„ P1-3 ç«¯åˆ°ç«¯æµ‹è¯• - æ¨èæµç¨‹

### æ­¥éª¤ 1: é‡‡é›†æ–°é—» (2-3 åˆ†é’Ÿ)

```bash
python scripts/run_collection.py
```

**è¾“å‡ºå†…å®¹ï¼š**
- é‡‡é›†ç»Ÿè®¡ (æ€»æ•°ã€æ–°å¢ã€é‡å¤)
- TOP 10 æ–°é—»åˆ—è¡¨
- æ•°æ®åº“æŸ¥è¯¢å‘½ä»¤

**éªŒæ”¶æ ‡å‡†ï¼š**
- [ ] é‡‡é›† > 100 æ¡æ–°é—»
- [ ] æ–°å¢ > 80 æ¡
- [ ] æ— é‡‡é›†é”™è¯¯

---

### æ­¥éª¤ 2: è¯„åˆ†æ–°é—» (3-5 åˆ†é’Ÿ)

```bash
python scripts/test-batch-scoring.py
```

**è¾“å‡ºå†…å®¹ï¼š**
- è¯„åˆ†æ•°é‡å’ŒæˆåŠŸç‡
- æˆæœ¬ç»Ÿè®¡
- æ€§èƒ½æ•°æ®

**éªŒæ”¶æ ‡å‡†ï¼š**
- [ ] è¯„åˆ†æˆåŠŸç‡ > 95%
- [ ] è€—æ—¶ < 10 ç§’/æ¡
- [ ] æˆæœ¬ < $1 / 100æ¡

---

### æ­¥éª¤ 3: æŸ¥çœ‹æ•°æ®åº“ç»“æœ

åˆ›å»ºå¿«é€ŸæŸ¥è¯¢è„šæœ¬ï¼ˆè§ä¸‹æ–‡ï¼‰æŸ¥çœ‹ï¼š
- raw_news è¡¨çš„æ–°æ•°æ®
- processed_news è¡¨çš„è¯„åˆ†ç»“æœ
- ç»Ÿè®¡ä¿¡æ¯

**éªŒæ”¶æ ‡å‡†ï¼š**
- [ ] raw_news å­—æ®µå®Œæ•´
- [ ] processed_news æœ‰è¯„åˆ†æ•°æ®
- [ ] æ²¡æœ‰é”™è¯¯æˆ–å¼‚å¸¸

---

## ğŸ“Š å¿«é€Ÿæ•°æ®åº“æŸ¥çœ‹è„šæœ¬

åˆ›å»º `scripts/view_database_summary.py`ï¼š

```python
#!/usr/bin/env python
"""å¿«é€ŸæŸ¥çœ‹æ•°æ®åº“æ‘˜è¦"""
import sys
sys.path.insert(0, '.')

from sqlalchemy import create_engine, text

db = create_engine('sqlite:///data/db/deepdive_tracking.db')

with db.connect() as conn:
    # raw_news ç»Ÿè®¡
    result = conn.execute(text('''
        SELECT COUNT(*) as total,
               COUNT(CASE WHEN status='raw' THEN 1 END) as raw,
               COUNT(CASE WHEN status='processed' THEN 1 END) as processed,
               COUNT(CASE WHEN author IS NOT NULL THEN 1 END) as with_author
        FROM raw_news
    '''))
    row = result.fetchone()
    print(f"raw_news: æ€»æ•°={row[0]}, å¾…å¤„ç†={row[1]}, å·²å¤„ç†={row[2]}, æœ‰author={row[3]}")

    # TOP 10
    result = conn.execute(text('''
        SELECT title, source_name, author, LENGTH(content) as content_len
        FROM raw_news
        ORDER BY fetched_at DESC
        LIMIT 10
    '''))
    print("\nTOP 10 æœ€æ–°æ–°é—»:")
    for i, (title, source, author, content_len) in enumerate(result, 1):
        print(f"{i}. [{source}] {title[:50]}...")
        print(f"   Author: {author}, Content: {content_len} chars")
```

è¿è¡Œï¼š
```bash
python scripts/view_database_summary.py
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: è„šæœ¬è¿è¡Œå‡ºé”™è¯´"no such column"

**åŸå› ï¼š** æ•°æ®åº“è¡¨ç»“æ„ä¸ä¸€è‡´

**è§£å†³ï¼š**
```bash
# æ¸…ç©ºæ•°æ®åº“é‡æ–°åˆ›å»º
rm data/db/deepdive_tracking.db
python scripts/run_collection.py  # ä¼šè‡ªåŠ¨åˆ›å»ºè¡¨
```

### Q2: é‡‡é›†å¾ˆæ…¢æˆ–è¶…æ—¶

**åŸå› ï¼š** ç½‘ç»œé—®é¢˜æˆ–æºä¸å¯ç”¨

**è§£å†³ï¼š**
```bash
# è¿è¡Œè¯Šæ–­æ‰¾å‡ºé—®é¢˜æº
python scripts/diagnose-api.py
```

### Q3: è¯„åˆ†å¤±è´¥æˆ–æˆæœ¬å¾ˆé«˜

**åŸå› ï¼š** API Key é…ç½®æˆ–æ¨¡å‹é€‰æ‹©

**è§£å†³ï¼š**
```bash
# æµ‹è¯• API è¿æ¥
python scripts/test-real-api.py

# æ£€æŸ¥ .env ä¸­çš„ OPENAI_API_KEY
cat .env | grep OPENAI
```

### Q4: æƒ³çœ‹æ›´è¯¦ç»†çš„æ•°æ®

**æ–¹æ³•1ï¼š** ä½¿ç”¨ SQLite å‘½ä»¤è¡Œ
```bash
sqlite3 data/db/deepdive_tracking.db
> SELECT * FROM raw_news LIMIT 5;
> SELECT * FROM processed_news LIMIT 5;
```

**æ–¹æ³•2ï¼š** ç¼–å†™è‡ªå®šä¹‰æŸ¥è¯¢è„šæœ¬ï¼ˆè§ä¸Šæ–‡ï¼‰

---

## ğŸš€ P1-3 å¿«é€Ÿå¯åŠ¨

ä¸€é”®è¿è¡Œ P1-3 ç«¯åˆ°ç«¯æµ‹è¯•ï¼š

```bash
# æ­¥éª¤1: é‡‡é›†
echo "=== Step 1: Collection ===" && \
python scripts/run_collection.py && \

# æ­¥éª¤2: è¯„åˆ†
echo "=== Step 2: Scoring ===" && \
python scripts/test-batch-scoring.py && \

# æ­¥éª¤3: éªŒè¯
echo "=== Step 3: Verification ===" && \
python scripts/view_database_summary.py
```

---

## ğŸ“ è„šæœ¬é€‰æ‹©çŸ©é˜µ

```
éœ€æ±‚                      è„šæœ¬                        è€—æ—¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®Œæ•´é‡‡é›†+æ˜¾ç¤ºTOP10        run_collection.py           2min
å¿«é€ŸAPIè¯Šæ–­              test-real-api.py            30s
æ‰¹é‡è¯„åˆ†                 test-batch-scoring.py       5min
é‡æ–°è¯„åˆ†å¤±è´¥çš„æ–‡ç«        score-raw-news.py           3min
è¯Šæ–­é‡‡é›†é—®é¢˜             diagnose-api.py             1min
é…ç½®æºå…ƒæ•°æ®             configure_default_authors   1s
æŸ¥çœ‹æ•°æ®åº“æ‘˜è¦           view_database_summary       10s
å®Œæ•´ç«¯åˆ°ç«¯æµ‹è¯•           run_collection + scoring    10min
```

---

**æ€»ç»“ï¼š** å¯¹äº P1-3 ç«¯åˆ°ç«¯æµ‹è¯•ï¼ŒæŒ‰é¡ºåºè¿è¡Œï¼š
1. `python scripts/run_collection.py`
2. `python scripts/test-batch-scoring.py`
3. æ‰‹åŠ¨æˆ–è„šæœ¬æŸ¥çœ‹æ•°æ®åº“ç»“æœ

